"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true,
});
var tslib_1 = require("tslib");
var InvalidPayloadError_1 = tslib_1.__importDefault(require("../../interfaces/rest/errors/InvalidPayloadError"));
var ResourceNotFoundError_1 = tslib_1.__importDefault(
  require("../../interfaces/rest/errors/ResourceNotFoundError"),
);
var mongoose_1 = tslib_1.__importDefault(require("mongoose"));
var BaseRepository = /** @class */ (function () {
  /**
   * @constructor
   * @param {*} param0
   */
  function BaseRepository(_a) {
    var Model = _a.Model;
    this.Collection = Model;
    this.modelName = this.Collection.modelName;
  }
  // eslint-disable-next-line class-methods-use-this
  BaseRepository.prototype.isValidId = function (documentId) {
    return mongoose_1.default.Types.ObjectId.isValid(documentId);
  };
  BaseRepository.prototype.count = function (query) {
    if (query === void 0) {
      query = {};
    }
    return tslib_1.__awaiter(this, void 0, void 0, function () {
      return tslib_1.__generator(this, function (_a) {
        return [2 /*return*/, this.Collection.countDocuments(query)];
      });
    });
  };
  BaseRepository.prototype.totalCount = function () {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
      return tslib_1.__generator(this, function (_a) {
        return [2 /*return*/, this.Collection.estimatedDocumentCount()];
      });
    });
  };
  /* Full list of option - https://mongoosejs.com/docs/api.html#query_Query-setOptions */
  /**
   *
   * @param {*} query
   * @param {*} projection
   * @param {*} options
   * @param {*} multiple
   * @returns {Document}
   * @memberof BaseRepository
   */
  BaseRepository.prototype.find = function (query, projection, options, multiple) {
    if (query === void 0) {
      query = {};
    }
    if (projection === void 0) {
      projection = {};
    }
    if (options === void 0) {
      options = {};
    }
    if (multiple === void 0) {
      multiple = false;
    }
    return tslib_1.__awaiter(this, void 0, void 0, function () {
      var results;
      return tslib_1.__generator(this, function (_a) {
        results = multiple
          ? this.Collection.find(query, projection, options)
          : options.session
          ? this.Collection.findOne(query).session(options.session).select(projection)
          : this.Collection.findOne(query, projection, options);
        return [2 /*return*/, results.exec()];
      });
    });
  };
  /**
   *
   * @param {*} documentId
   * @param {*} projection
   * @param {*} options
   * @returns {Document}
   * @memberof BaseRepository
   */
  BaseRepository.prototype.findById = function (documentId, projection, options) {
    if (projection === void 0) {
      projection = {};
    }
    if (options === void 0) {
      options = {};
    }
    return tslib_1.__awaiter(this, void 0, void 0, function () {
      var document, _a;
      return tslib_1.__generator(this, function (_b) {
        switch (_b.label) {
          case 0:
            if (!this.isValidId(documentId)) {
              throw new InvalidPayloadError_1.default("Invalid ".concat(this.modelName, "Id"));
            }
            if (!options.session) return [3 /*break*/, 2];
            return [
              4 /*yield*/,
              this.Collection.findById(documentId)
                .session(options.session)
                .select(projection)
                .setOptions(options),
            ];
          case 1:
            _a = _b.sent();
            return [3 /*break*/, 4];
          case 2:
            return [4 /*yield*/, this.Collection.findById(documentId).select(projection).setOptions(options)];
          case 3:
            _a = _b.sent();
            _b.label = 4;
          case 4:
            document = _a;
            if (!document) {
              throw new ResourceNotFoundError_1.default("".concat(this.modelName, " not found"));
            }
            return [2 /*return*/, document];
        }
      });
    });
  };
  /**
   *
   * @param {*} query
   * @param {*} update
   * @param {*} options
   * @returns {Document}
   * @memberof BaseRepository
   */
  BaseRepository.prototype.findOneAndUpdate = function (query, update, options) {
    if (query === void 0) {
      query = {};
    }
    if (update === void 0) {
      update = {};
    }
    if (options === void 0) {
      options = {};
    }
    return tslib_1.__awaiter(this, void 0, void 0, function () {
      var document;
      return tslib_1.__generator(this, function (_a) {
        switch (_a.label) {
          case 0:
            if (query._id && !this.isValidId(query._id)) {
              throw new InvalidPayloadError_1.default("Invalid ".concat(this.modelName, "Id"));
            }
            return [4 /*yield*/, this.Collection.findOneAndUpdate(query, update, options)];
          case 1:
            document = _a.sent();
            if (!document) {
              throw new ResourceNotFoundError_1.default("".concat(this.modelName, " not found"));
            }
            return [2 /*return*/, document];
        }
      });
    });
  };
  /**
   *
   * @param {*} body
   * @param {*} session
   * @returns {Document}
   * @memberof BaseRepository
   */
  BaseRepository.prototype.createDoc = function (body, session) {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
      var document;
      return tslib_1.__generator(this, function (_a) {
        document = new this.Collection(body);
        document = session
          ? document.save({
              session: session,
            })
          : document.save();
        return [2 /*return*/, document];
      });
    });
  };
  /**
   * Update a document
   * @param {*} query
   * @param {Object} body
   * @param {Object} options
   * @returns {Document}
   * @memberof BaseRepository
   */
  BaseRepository.prototype.update = function (query, update, options) {
    if (update === void 0) {
      update = {};
    }
    if (options === void 0) {
      options = {};
    }
    return tslib_1.__awaiter(this, void 0, void 0, function () {
      var document;
      return tslib_1.__generator(this, function (_a) {
        switch (_a.label) {
          case 0:
            if (query._id && !this.isValidId(query._id)) {
              throw new InvalidPayloadError_1.default("Invalid ".concat(this.modelName, "Id"));
            }
            return [4 /*yield*/, this.Collection.update(query, update, options)];
          case 1:
            document = _a.sent();
            if (!document) {
              throw new ResourceNotFoundError_1.default("".concat(this.modelName, " not found"));
            }
            return [2 /*return*/, document];
        }
      });
    });
  };
  /**
   *
   * @param {*} query
   * @param {*} update
   * @param {*} options
   * @returns {Document}
   * @memberof BaseRepository
   */
  BaseRepository.prototype.findOneAndDelete = function (query, options) {
    if (query === void 0) {
      query = {};
    }
    if (options === void 0) {
      options = {};
    }
    return tslib_1.__awaiter(this, void 0, void 0, function () {
      var document;
      return tslib_1.__generator(this, function (_a) {
        switch (_a.label) {
          case 0:
            if (query._id && !this.isValidId(query._id)) {
              throw new InvalidPayloadError_1.default("Invalid ".concat(this.modelName, "Id"));
            }
            return [4 /*yield*/, this.Collection.findOneAndDelete(query, options)];
          case 1:
            document = _a.sent();
            if (!document) {
              throw new ResourceNotFoundError_1.default("".concat(this.modelName, " not found"));
            }
            return [2 /*return*/, document];
        }
      });
    });
  };
  return BaseRepository;
})();
exports.default = BaseRepository;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInRzbGliXzEiLCJyZXF1aXJlIiwiSW52YWxpZFBheWxvYWRFcnJvcl8xIiwiX19pbXBvcnREZWZhdWx0IiwiUmVzb3VyY2VOb3RGb3VuZEVycm9yXzEiLCJtb25nb29zZV8xIiwiQmFzZVJlcG9zaXRvcnkiLCJfYSIsIk1vZGVsIiwiQ29sbGVjdGlvbiIsIm1vZGVsTmFtZSIsInByb3RvdHlwZSIsImlzVmFsaWRJZCIsImRvY3VtZW50SWQiLCJkZWZhdWx0IiwiVHlwZXMiLCJPYmplY3RJZCIsImlzVmFsaWQiLCJjb3VudCIsInF1ZXJ5IiwiX19hd2FpdGVyIiwiX19nZW5lcmF0b3IiLCJjb3VudERvY3VtZW50cyIsInRvdGFsQ291bnQiLCJlc3RpbWF0ZWREb2N1bWVudENvdW50IiwiZmluZCIsInByb2plY3Rpb24iLCJvcHRpb25zIiwibXVsdGlwbGUiLCJyZXN1bHRzIiwic2Vzc2lvbiIsImZpbmRPbmUiLCJzZWxlY3QiLCJleGVjIiwiZmluZEJ5SWQiLCJkb2N1bWVudCIsIl9iIiwibGFiZWwiLCJjb25jYXQiLCJzZXRPcHRpb25zIiwic2VudCIsImZpbmRPbmVBbmRVcGRhdGUiLCJ1cGRhdGUiLCJfaWQiLCJjcmVhdGVEb2MiLCJib2R5Iiwic2F2ZSIsImZpbmRPbmVBbmREZWxldGUiXSwic291cmNlcyI6WyIuLi8uLi8uLi90eXBlZC9iYXNlL3JlcG9zaXRvcmllcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIEludmFsaWRQYXlsb2FkRXJyb3JfMSA9IHRzbGliXzEuX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJpbnRlcmZhY2VzL3Jlc3QvZXJyb3JzL0ludmFsaWRQYXlsb2FkRXJyb3JcIikpO1xudmFyIFJlc291cmNlTm90Rm91bmRFcnJvcl8xID0gdHNsaWJfMS5fX2ltcG9ydERlZmF1bHQocmVxdWlyZShcImludGVyZmFjZXMvcmVzdC9lcnJvcnMvUmVzb3VyY2VOb3RGb3VuZEVycm9yXCIpKTtcbnZhciBtb25nb29zZV8xID0gdHNsaWJfMS5fX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIm1vbmdvb3NlXCIpKTtcbnZhciBCYXNlUmVwb3NpdG9yeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0geyp9IHBhcmFtMFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEJhc2VSZXBvc2l0b3J5KF9hKSB7XG4gICAgICAgIHZhciBNb2RlbCA9IF9hLk1vZGVsO1xuICAgICAgICB0aGlzLkNvbGxlY3Rpb24gPSBNb2RlbDtcbiAgICAgICAgdGhpcy5tb2RlbE5hbWUgPSB0aGlzLkNvbGxlY3Rpb24ubW9kZWxOYW1lO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2xhc3MtbWV0aG9kcy11c2UtdGhpc1xuICAgIEJhc2VSZXBvc2l0b3J5LnByb3RvdHlwZS5pc1ZhbGlkSWQgPSBmdW5jdGlvbiAoZG9jdW1lbnRJZCkge1xuICAgICAgICByZXR1cm4gbW9uZ29vc2VfMS5kZWZhdWx0LlR5cGVzLk9iamVjdElkLmlzVmFsaWQoZG9jdW1lbnRJZCk7XG4gICAgfTtcbiAgICBCYXNlUmVwb3NpdG9yeS5wcm90b3R5cGUuY291bnQgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgaWYgKHF1ZXJ5ID09PSB2b2lkIDApIHsgcXVlcnkgPSB7fTsgfVxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLkNvbGxlY3Rpb24uY291bnREb2N1bWVudHMocXVlcnkpXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEJhc2VSZXBvc2l0b3J5LnByb3RvdHlwZS50b3RhbENvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLkNvbGxlY3Rpb24uZXN0aW1hdGVkRG9jdW1lbnRDb3VudCgpXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qIEZ1bGwgbGlzdCBvZiBvcHRpb24gLSBodHRwczovL21vbmdvb3NlanMuY29tL2RvY3MvYXBpLmh0bWwjcXVlcnlfUXVlcnktc2V0T3B0aW9ucyAqL1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHsqfSBxdWVyeVxuICAgICAqIEBwYXJhbSB7Kn0gcHJvamVjdGlvblxuICAgICAqIEBwYXJhbSB7Kn0gb3B0aW9uc1xuICAgICAqIEBwYXJhbSB7Kn0gbXVsdGlwbGVcbiAgICAgKiBAcmV0dXJucyB7RG9jdW1lbnR9XG4gICAgICogQG1lbWJlcm9mIEJhc2VSZXBvc2l0b3J5XG4gICAgICovXG4gICAgQmFzZVJlcG9zaXRvcnkucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbiAocXVlcnksIHByb2plY3Rpb24sIG9wdGlvbnMsIG11bHRpcGxlKSB7XG4gICAgICAgIGlmIChxdWVyeSA9PT0gdm9pZCAwKSB7IHF1ZXJ5ID0ge307IH1cbiAgICAgICAgaWYgKHByb2plY3Rpb24gPT09IHZvaWQgMCkgeyBwcm9qZWN0aW9uID0ge307IH1cbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICAgICAgaWYgKG11bHRpcGxlID09PSB2b2lkIDApIHsgbXVsdGlwbGUgPSBmYWxzZTsgfVxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHRzO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0cyA9IG11bHRpcGxlXG4gICAgICAgICAgICAgICAgICAgID8gdGhpcy5Db2xsZWN0aW9uLmZpbmQocXVlcnksIHByb2plY3Rpb24sIG9wdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgIDogb3B0aW9ucy5zZXNzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuQ29sbGVjdGlvbi5maW5kT25lKHF1ZXJ5KS5zZXNzaW9uKG9wdGlvbnMuc2Vzc2lvbikuc2VsZWN0KHByb2plY3Rpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMuQ29sbGVjdGlvbi5maW5kT25lKHF1ZXJ5LCBwcm9qZWN0aW9uLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcmVzdWx0cy5leGVjKCldO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyp9IGRvY3VtZW50SWRcbiAgICAgKiBAcGFyYW0geyp9IHByb2plY3Rpb25cbiAgICAgKiBAcGFyYW0geyp9IG9wdGlvbnNcbiAgICAgKiBAcmV0dXJucyB7RG9jdW1lbnR9XG4gICAgICogQG1lbWJlcm9mIEJhc2VSZXBvc2l0b3J5XG4gICAgICovXG4gICAgQmFzZVJlcG9zaXRvcnkucHJvdG90eXBlLmZpbmRCeUlkID0gZnVuY3Rpb24gKGRvY3VtZW50SWQsIHByb2plY3Rpb24sIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKHByb2plY3Rpb24gPT09IHZvaWQgMCkgeyBwcm9qZWN0aW9uID0ge307IH1cbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZG9jdW1lbnQsIF9hO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNWYWxpZElkKGRvY3VtZW50SWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXlsb2FkRXJyb3JfMS5kZWZhdWx0KFwiSW52YWxpZCBcIi5jb25jYXQodGhpcy5tb2RlbE5hbWUsIFwiSWRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zLnNlc3Npb24pIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5Db2xsZWN0aW9uLmZpbmRCeUlkKGRvY3VtZW50SWQpLnNlc3Npb24ob3B0aW9ucy5zZXNzaW9uKS5zZWxlY3QocHJvamVjdGlvbikuc2V0T3B0aW9ucyhvcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5Db2xsZWN0aW9uLmZpbmRCeUlkKGRvY3VtZW50SWQpLnNlbGVjdChwcm9qZWN0aW9uKS5zZXRPcHRpb25zKG9wdGlvbnMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50ID0gX2E7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRvY3VtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJlc291cmNlTm90Rm91bmRFcnJvcl8xLmRlZmF1bHQoXCJcIi5jb25jYXQodGhpcy5tb2RlbE5hbWUsIFwiIG5vdCBmb3VuZFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZG9jdW1lbnRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHsqfSBxdWVyeVxuICAgICAqIEBwYXJhbSB7Kn0gdXBkYXRlXG4gICAgICogQHBhcmFtIHsqfSBvcHRpb25zXG4gICAgICogQHJldHVybnMge0RvY3VtZW50fVxuICAgICAqIEBtZW1iZXJvZiBCYXNlUmVwb3NpdG9yeVxuICAgICAqL1xuICAgIEJhc2VSZXBvc2l0b3J5LnByb3RvdHlwZS5maW5kT25lQW5kVXBkYXRlID0gZnVuY3Rpb24gKHF1ZXJ5LCB1cGRhdGUsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKHF1ZXJ5ID09PSB2b2lkIDApIHsgcXVlcnkgPSB7fTsgfVxuICAgICAgICBpZiAodXBkYXRlID09PSB2b2lkIDApIHsgdXBkYXRlID0ge307IH1cbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZG9jdW1lbnQ7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWVyeS5faWQgJiYgIXRoaXMuaXNWYWxpZElkKHF1ZXJ5Ll9pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFBheWxvYWRFcnJvcl8xLmRlZmF1bHQoXCJJbnZhbGlkIFwiLmNvbmNhdCh0aGlzLm1vZGVsTmFtZSwgXCJJZFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLkNvbGxlY3Rpb24uZmluZE9uZUFuZFVwZGF0ZShxdWVyeSwgdXBkYXRlLCBvcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkb2N1bWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZXNvdXJjZU5vdEZvdW5kRXJyb3JfMS5kZWZhdWx0KFwiXCIuY29uY2F0KHRoaXMubW9kZWxOYW1lLCBcIiBub3QgZm91bmRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGRvY3VtZW50XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Kn0gYm9keVxuICAgICAqIEBwYXJhbSB7Kn0gc2Vzc2lvblxuICAgICAqIEByZXR1cm5zIHtEb2N1bWVudH1cbiAgICAgKiBAbWVtYmVyb2YgQmFzZVJlcG9zaXRvcnlcbiAgICAgKi9cbiAgICBCYXNlUmVwb3NpdG9yeS5wcm90b3R5cGUuY3JlYXRlRG9jID0gZnVuY3Rpb24gKGJvZHksIHNlc3Npb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZG9jdW1lbnQ7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudCA9IG5ldyB0aGlzLkNvbGxlY3Rpb24oYm9keSk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQgPSBzZXNzaW9uID8gZG9jdW1lbnQuc2F2ZSh7IHNlc3Npb246IHNlc3Npb24gfSkgOiBkb2N1bWVudC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGRvY3VtZW50XTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBhIGRvY3VtZW50XG4gICAgICogQHBhcmFtIHsqfSBxdWVyeVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBib2R5XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICAgKiBAcmV0dXJucyB7RG9jdW1lbnR9XG4gICAgICogQG1lbWJlcm9mIEJhc2VSZXBvc2l0b3J5XG4gICAgICovXG4gICAgQmFzZVJlcG9zaXRvcnkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChxdWVyeSwgdXBkYXRlLCBvcHRpb25zKSB7XG4gICAgICAgIGlmICh1cGRhdGUgPT09IHZvaWQgMCkgeyB1cGRhdGUgPSB7fTsgfVxuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkb2N1bWVudDtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXJ5Ll9pZCAmJiAhdGhpcy5pc1ZhbGlkSWQocXVlcnkuX2lkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUGF5bG9hZEVycm9yXzEuZGVmYXVsdChcIkludmFsaWQgXCIuY29uY2F0KHRoaXMubW9kZWxOYW1lLCBcIklkXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuQ29sbGVjdGlvbi51cGRhdGUocXVlcnksIHVwZGF0ZSwgb3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZG9jdW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVzb3VyY2VOb3RGb3VuZEVycm9yXzEuZGVmYXVsdChcIlwiLmNvbmNhdCh0aGlzLm1vZGVsTmFtZSwgXCIgbm90IGZvdW5kXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBkb2N1bWVudF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyp9IHF1ZXJ5XG4gICAgICogQHBhcmFtIHsqfSB1cGRhdGVcbiAgICAgKiBAcGFyYW0geyp9IG9wdGlvbnNcbiAgICAgKiBAcmV0dXJucyB7RG9jdW1lbnR9XG4gICAgICogQG1lbWJlcm9mIEJhc2VSZXBvc2l0b3J5XG4gICAgICovXG4gICAgQmFzZVJlcG9zaXRvcnkucHJvdG90eXBlLmZpbmRPbmVBbmREZWxldGUgPSBmdW5jdGlvbiAocXVlcnksIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKHF1ZXJ5ID09PSB2b2lkIDApIHsgcXVlcnkgPSB7fTsgfVxuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkb2N1bWVudDtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXJ5Ll9pZCAmJiAhdGhpcy5pc1ZhbGlkSWQocXVlcnkuX2lkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUGF5bG9hZEVycm9yXzEuZGVmYXVsdChcIkludmFsaWQgXCIuY29uY2F0KHRoaXMubW9kZWxOYW1lLCBcIklkXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuQ29sbGVjdGlvbi5maW5kT25lQW5kRGVsZXRlKHF1ZXJ5LCBvcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkb2N1bWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZXNvdXJjZU5vdEZvdW5kRXJyb3JfMS5kZWZhdWx0KFwiXCIuY29uY2F0KHRoaXMubW9kZWxOYW1lLCBcIiBub3QgZm91bmRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGRvY3VtZW50XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQmFzZVJlcG9zaXRvcnk7XG59KCkpO1xuZXhwb3J0cy5kZWZhdWx0ID0gQmFzZVJlcG9zaXRvcnk7XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBQ1pBLE1BQU0sQ0FBQ0MsY0FBYyxDQUFDQyxPQUFPLEVBQUUsWUFBWSxFQUFFO0VBQUVDLEtBQUssRUFBRTtBQUFLLENBQUMsQ0FBQztBQUM3RCxJQUFJQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxPQUFPLENBQUM7QUFDOUIsSUFBSUMscUJBQXFCLEdBQUdGLE9BQU8sQ0FBQ0csZUFBZSxDQUFDRixPQUFPLG9EQUE4QyxDQUFDO0FB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
